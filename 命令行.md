---
title: å‘½ä»¤è¡Œæ‰§è¡Œ
date: 2022-12-7
tags:
    - å‘½ä»¤è¡Œ
categories:
    - å‰ç«¯
---

# å‘½ä»¤è¡Œç¼–å†™

## 1.è¿è¡Œé€»è¾‘
åœ¨`package.json`ä¸­ï¼Œä½¿ç”¨"bin":{...}ç¼–å†™è¿è¡Œå‘½ä»¤ï¼Œä½¿ç”¨`npm install -g é¡¹ç›®å`

**1.è¿è¡Œ**
```sh
# å…¨å±€å®‰è£…
npm install -g é¡¹ç›®å
# å¸è½½
npm uninstall -g é¡¹ç›®å
```

**2.package.jsonè®¾ç½®**
```json
  "bin": {
    "folder-print": "./bin/cli.js",
    "fp": "./bin/cli.js"
  },
  "keywords": [
    "folder",
    "file",
    "directory structure",
    "tree",
    "log",
    "file-tree",
    "folder-print"
  ],
```

## 2.jså‘½ä»¤è¡Œ
è¿è¡Œé¡¹ç›®ï¼š
æ³¨æ„ï¼špackage.jsonä¸­æ·»åŠ   "type": "module",å¹¶ä¸”ä½¿ç”¨ node --experimental-modules æ–‡ä»¶æ¥è¿è¡Œ
### 2.1.Commandåˆ›å»ºåº“
** 1.åˆ›å»ºï¼š**
ä½¿ç”¨äº† commander åº“åˆ›å»ºäº†ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·
```js
const { Command } = require("commander");
const program = new Command();
```
** 2.è®¾ç½®ä¿¡æ¯ **
å¯¼å…¥äº† Command ç±»å¹¶åˆ›å»ºäº†ä¸€ä¸ª program å®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹ç”¨äºå®šä¹‰å‘½ä»¤è¡Œå·¥å…·çš„å‘½ä»¤ã€é€‰é¡¹å’Œå¸®åŠ©ä¿¡æ¯

** 2.1.åŸºæœ¬ä¿¡æ¯ **
```js
program
  .name("folder-print")
  .description("Using the CLI to generate the tree structure of the directory")
  .version(version, "-v, --version, -V");
```
- .name("folder-print")ï¼šè®¾ç½®å‘½ä»¤è¡Œå·¥å…·çš„åç§°ä¸º "folder-print"ã€‚
- .description("Using the CLI to generate the tree structure of the directory")ï¼šè®¾ç½®å·¥å…·çš„æè¿°ã€‚
- .version(version, "-v, --version, -V")ï¼šè®¾ç½®å·¥å…·çš„ç‰ˆæœ¬å·ï¼Œå¹¶å®šä¹‰äº† -v, --version, -V è¿™å‡ ä¸ªé€‰é¡¹ç”¨äºæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯

** 2.2.optioné€‰é¡¹å®šä¹‰ **
1.è®¾ç½®å‘½ä»¤è¡Œçš„é€‰é¡¹
```js
// éå†æ·±åº¦
program.option(
  "-d, --depth <type>",
  "Set the depth of the folder to be traversed",
  "10"
);
// æ‰“å°
program.option("-p, --print", "Generate a markdown file");
```
- -d, --depth <type>ï¼šç”¨äºè®¾ç½®éå†æ–‡ä»¶å¤¹çš„æ·±åº¦ï¼Œé»˜è®¤å€¼æ˜¯ "10"ã€‚
- -p, --printï¼šç”¨äºç”Ÿæˆä¸€ä¸ª Markdown æ–‡ä»¶ã€‚


2.åœ¨å®šä¹‰å®Œé€‰é¡¹åï¼Œæˆ‘ä»¬éœ€è¦æ‰§è¡Œè¿™äº›å‚æ•°ï¼Œå°±å¯ä»¥ä½¿ç”¨`parse`æ¥æ‰§è¡Œå‚æ•°
parse æ–¹æ³•ä¼šè§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶æ‰§è¡Œç›¸åº”çš„å‘½ä»¤æˆ–é€‰é¡¹çš„å›è°ƒå‡½æ•°ã€‚åœ¨
```js
// æ‰§è¡Œå‘½ä»¤è¡Œå‚æ•°
program.parse(process.argv);
```

3.è·å–ä¿¡æ¯opt()
```js
const depth = program.opts().depth;
const print = program.opts().print;
```
æ¥è·å–å‚æ•°ä¿¡æ¯ï¼Œæˆ–è€…é€‰é¡¹ä¸­çš„è®¾ç½®çš„æ•°æ®

** 2.3.Commandæ·»åŠ å‘½ä»¤ **
è¯¥æ–¹æ³•å…è®¸ä½¿ç”¨å‘½ä»¤è¡Œå»æ‰§è¡Œä¸€æ®µå‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯ä¸€æ®µï¼š
```js
program
    .version('0.0.1','-v','--version')
    .commond('rm<dir>')
    .action(function(){
        console.log('remove ' + dir + (cmd.recursive ? ' recursively' : ''))
    })
program.parse(process.argv);
```
commandå‡½æ•°ä¸­çš„å‚æ•°ï¼š
- å‘½ä»¤åé¢å¯è·Ÿç”¨<>æˆ–[]åŒ…å«çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š`rm<dir>`
- æ‰§è¡Œå‘½ä»¤åï¼Œå°†éªŒè¯å‘½ä»¤çš„optionsï¼Œæ²¡æœ‰åˆ™ä¼šæŠ¥é”™
- å¦‚æœä½¿ç”¨action,é‚£ä¹ˆå°±ä¸ç”¨éªŒè¯options

** 2.4.helpOption å¸®åŠ©**
æä¾›å¸®åŠ©ä¿¡æ¯
```js
program
  .version('0.1.0')
  .helpOption('-h,--HELP')
  .option('-f, --foo', 'enable some foo')
  .option('-b, --bar', 'enable some bar')
  .option('-B, --baz', 'enable some baz');
program.parse(process.argv);
 
//  æ‰§è¡Œå‘½ä»¤
//  node index -h æˆ– node index --HELP

```

** 2.5.è‡ªå®šä¹‰äº‹ä»¶ä¾¦å¬å™¨ **
ç”¨äºæ•è·optionä¸commandï¼Œå½“å…¶è¢«ä½¿ç”¨ä¼šè§¦å‘
```js
program.
    option('-a','--am','amm-print')

program.on('option:am', function () {
  console.log("on:am")
});
//  æ‰§è¡Œå‘½ä»¤
//  node index -a:am
```


### 3.inquirerjs 
Inquirer æ˜¯å¸¸è§„äº¤äº’å¼å‘½ä»¤è¡Œç”¨æˆ·æ¥å£çš„é›†åˆï¼Œæä¾›ç»™ Node.js ä¸€ä¸ªæ–¹ä¾¿åµŒå…¥ï¼Œæ¼‚äº®çš„å‘½ä»¤è¡Œæ¥å£ã€‚
Inquirer ä¼šç®€åŒ–è¯¢é—®ç»ˆç«¯ç”¨æˆ·é—®é¢˜ï¼Œè§£æï¼ŒéªŒè¯ç­”æ¡ˆï¼Œæä¾›é”™è¯¯åé¦ˆç­‰ç­‰åŠŸèƒ½
** ä½¿ç”¨ **
```js
var inquirer = require('inquirer');
inquirer
  .prompt([
    /* åœ¨è¿™é‡Œé…ç½®æ‚¨çš„é—®é¢˜ï¼ˆå¯ä»¥è®¾ç½®å¤šä¸ªï¼Œå®ƒä»¬å°†æŒ‰é¡ºåºå‘ç”¨æˆ·æå‡ºï¼‰ */
  ])
  .then(answers => {
    // å›è°ƒï¼Œå¯¹ç”¨æˆ·è¾“å…¥çš„ç­”æ¡ˆå°±è¡Œå¤„ç†
  });
```
``
> å…¶ä¸­ï¼Œç®€å•åŠŸèƒ½å‚æ•°ä»‹ç»
- typeï¼šè¡¨ç¤ºæé—®çš„ç±»å‹ï¼ŒåŒ…æ‹¬ï¼šinputã€confirmã€ listã€rawlistã€expandã€checkboxã€passwordã€ - editorã€‚
- name: å­˜å‚¨å½“å‰è¾“å…¥çš„å€¼ã€‚
- messageï¼šé—®é¢˜çš„æè¿°ã€‚
- defaultï¼šé»˜è®¤å€¼ã€‚
- choicesï¼šåˆ—è¡¨é€‰é¡¹ï¼Œåœ¨æŸäº›typeä¸‹å¯ç”¨ï¼Œå¹¶ä¸”åŒ…å«ä¸€ä¸ªåˆ†éš”ç¬¦(separator)ï¼›
- validateï¼šå¯¹ç”¨æˆ·çš„å›ç­”è¿›è¡Œæ ¡éªŒã€‚
- filterï¼šå¯¹ç”¨æˆ·çš„å›ç­”è¿›è¡Œè¿‡æ»¤å¤„ç†ï¼Œè¿”å›å¤„ç†åçš„å€¼ã€‚
- whenï¼šæ ¹æ®å‰é¢é—®é¢˜çš„å›ç­”ï¼Œåˆ¤æ–­å½“å‰é—®é¢˜æ˜¯å¦éœ€è¦è¢«å›ç­”ã€‚
- pageSizeï¼šä¿®æ”¹æŸäº›typeç±»å‹ä¸‹çš„æ¸²æŸ“è¡Œæ•°ã€‚
- prefixï¼šä¿®æ”¹messageé»˜è®¤å‰ç¼€ã€‚
- suffixï¼šä¿®æ”¹messageé»˜è®¤åç¼€ã€‚
```js
const open = require('open')
const inquirer = require('inquirer')
const qs = require('querystring')
// =========================================================
module.exports = function search(key) {
  console.log('ğŸš€ğŸš€ğŸš€ / key:', key)
  const engineList = [
    new inquirer.Separator('========å¸¸ç”¨======='),
    { name: 'Baidu', value: 'https://www.baidu.com/s?wd=' },
    { name: 'Google', value: 'https://www.google.com/search?q=' },
    { name: 'Github', value: 'https://github.com/search?q=' },
    { name: 'Npm', value: 'https://www.npmjs.com/search?q=' },
    { name: 'StackOverflow', value: 'https://stackoverflow.com/search?q=' },
    new inquirer.Separator('========å…¶ä»–======='),
    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
  ]
  const questions = [
    {
      type: 'list',
      name: 'engine', //å­˜å‚¨å½“å‰é—®é¢˜å›ç­”çš„å˜é‡keyï¼Œ
      message: 'è¯·é€‰æ‹©æœç´¢å¼•æ“:',
      choices: engineList,
    },
  ]
  // inquirer.prompt(questions)æ–¹æ³•ä¼šå°†questionså‚æ•°ä¸­çš„é—®é¢˜æé—®ç»™ç”¨æˆ·ï¼Œå¹¶å°†ç”¨æˆ·çš„å›ç­”å­˜å‚¨åœ¨answerså˜é‡ä¸­
  inquirer
    .prompt(questions)
    .then((res) => {
      open(res.engine + qs.unescape(key))
    })
    .catch((error) => {
      console.log('ğŸš€error:', error)
    })
}
```
